{% extends "admin/base_site.html" %}
{% load i18n %}
{% block breadcrumbs %}
{% load staticfiles %}
{% csrf_token %}

<link rel="stylesheet"  type="text/css" href="{% static "css/bootstrap.min.css" %}"/>
<script src="{% static "js/jquery.min.js" %}"></script>
<script src="{% static "js/bootstrap.min.js" %}"></script>

<div>
  <ol class="breadcrumb">
      <li><a href="{% url 'index' %}">Home</a></li>
  </ol>
</div>

<head>

<style>
  #rcorners2 {
    border-radius: 10px;
    border: 2px solid #dee0e2;
    background: white;
    padding: 20px;
    width:auto;
  }
</style>


<script>



var gform;

$(document).ready(function(){

    surveyformlist();

    $("[name='Questionid']").hide();
 
    $("[name='Optionid']").hide();

    $("[name='Optionsparam']").hide(); 

    $("[name='Operation']").hide();



    $("[name='formid']").on('change',function(event)
    { 
       // console.log(event.target.parents());
  
        var target = $(event.target);
        
        parentobject = target.parent().parent();

    //    console.log(p);

 
        formkey=parentobject.find("[name='formidselect'] option:selected").val();
       
        questionlist(parentobject,formkey);
    });

    $("[name='Questionid']").on('change',function(event)
    {

       // $("[name='Optionid']").hide(); 

         var target = $(event.target);
        
        parentobject = target.parent().parent();

        questionname=parentobject.find("[name='Questionidselect'] option:selected").text();

        optionlist(parentobject);
    });

    $("#Add").click(function(){
        $(".cardexample").first().clone(true).appendTo("#cardlist");
        $("#cardlist").children().show(); 
    });


    $("#Submit").click(function(){
      alert("submit button clicked"); 
      console.log("submit button clicked");
     cardlist= document.getElementById('cardlist').children;
      //cardlist=("#cardlist").children();
      console.log(cardlist[0]);
      console.log(cardlist);
    }); 




});


function emptyall(){
  
}


function surveyformlist(){

    var url = "{% url 'surveyformlist' %}";

    $.ajax({

        url : url,

        //data : {},

        type: "GET",

        contenttype : "json",

        success : function(json){

              var str='<option value="';
              str = str +"0" +'"'+'>' + "---select---" + '</option>';
              $("[name='formidselect']").append(str);

        for (i = 0; i < json.nameArray.length; i++){
                var str='<option value="';
                str = str +json.idArray[i] +'"'+'>' + json.nameArray[i] + '</option>';
                $("[name='formidselect']").append(str);
            }

        }


    });

}





function questionlist(parentobject,formkey){

      console.log("quetiondropdown");

      quetiondropdown =  parentobject.find("[name='Questionid']");

      console.log(quetiondropdown);

      quetionlist = parentobject.find("[name='Questionidselect']");

      Operation = parentobject.siblings().find("[name='Operation']");

      console.log("Operation");
      console.log(Operation);


      Optionsparam = parentobject.find("[name='Optionsparam']");

      console.log(quetionlist);

    
     //$(quetionlist).hide(); 

     $(Operation).hide();

     $(Optionsparam).hide(); 

     $(quetionlist).empty();

    var url = "{% url 'questionlist' %}";

    $.ajax({

        url : url,

        data : {id:formkey},

        type: "POST",

        contenttype : "json",

        success : function(json){

                gform=json["form"];  

                Questionarray=json["form"]; 

                if(Questionarray.length!=0)                 
                {  
                    var str='<option value="';
             
                    str = str +"0" +'"'+'>' + "---select---" + '</option>';
                    $(quetionlist).append(str);

                    for (i = 0; i < Questionarray.length; i++)
                    {
                        var str='<option value="';
                        str = str + Questionarray[i]["key"] +'"'+'>' + Questionarray[i]["value"] + '</option>';
                        $(quetionlist).append(str);
  
                    }  
                  
                    $(quetiondropdown).show();

                }  

              }  

    });


}


function optionlist(parentobject){


    console.log(questionname);

    formkey=parentobject.find("[name='formidselect'] option:selected").val();

    console.log("formkey");

    console.log(formkey);

    questionname = parentobject.find("[name='Questionidselect'] option:selected").text();

    console.log("questionname")

    console.log(questionname);


    Optioncheckboxlist = parentobject.find("[name='Optioncheckboxlist']");

    Optiondiv = parentobject.find("[name='Optionidselect']");

    Operation = parentobject.find("[name='Operation']");

    Optionsparam = parentobject.find("[name='Optionsparam']");



    $(Optioncheckboxlist).empty();


    var url = "{% url 'optionlist' %}";

    console.log(url);

    $.ajax({

        url : url,

        data : {formkey:formkey,questionname:questionname},

         type:'POST',

        contenttype : "json",

       

        success : function(json){

          optionslistarray=json;

          if(optionslistarray.length!=0)
          { 

     
            for(i = 0; i < optionslistarray.length; i++)
            {

                      str = "<li class=\"list-group-item\"><input type=\"checkbox\">   " 

                      str = str + optionslistarray[i]["value"] + "</li>"

                      $(Optioncheckboxlist).append(str);
  
            }  

            $(Optionsparam).show();
            Operation = parentobject.siblings();
            $(Operation).hide();
            $(Optiondiv).show();
           } 
          else{
            console.log("I am in else block");
            $(Optionsparam).hide();
            $(Optiondiv).hide();

            Operation = parentobject.siblings();
            console.log(Operation);
            $(Operation).show();
          }

      },

                 
      error: function(e){
              console.log(e);

      },

       
    

    });


}


</script>

</head>

<body>

<div style = "margin-left:2%;margin-right: 1%;display:none;" class="cardexample" id="cardexample" name="cardexample">

  <div id="rcorners2" style="width:90%;">
    
    <div class="row" >
        
        <div class = "col-md-2" name ="formid" id ="formid">
            
            <select id="formidselect" name ="formidselect" class="form-control">                  
            </select>

        </div>

        

       <div class = "col-md-5"  name = "Questionid" id ="Questionid">
            
            <select id="Questionidselect"  name = "Questionidselect" class="form-control">
            </select>

        </div>


        <div class = "col-md-2" name= "Optionsparam" id ="Optionsparam" >

            <select class="form-control">
             <option value=""> equal </option>
             <option value="">not equal </option>
            <option value="">answered</option>
             <option value="">not answered</option>
            </select> 

        </div>

        <div id="Optionidselect" name="Optionidselect" class="col-md-3" style="max-height:100px;overflow: auto;">
              <ul class="list-group" name ="Optioncheckboxlist" id="Optioncheckboxlist">
              </ul>
        </div>

    </div>




<br>

<div id ="Operation" name="Operation">
      <div class="row">
        
        <div class = "col-md-4" id ="">

          <select>
           <option value="<=">greater than equal to </option>
           <option value=">=">less than equal to</option>
           <option value=">">greater than</option>
           <option value="<">less than</option>
          </select> 

        </div>
          
         <div class = "col-md-4" id =""> 
              <input type="text" name="" value="">
         </div>         

      </div>  
    
    <br>

    <div class="row">
        
        <div class = "col-md-4" id ="">

          <select>
           <option value="<=">greater than equal to </option>
           <option value=">=">less than equal to</option>
           <option value=">">greater than</option>
           <option type="checkbox" value="<">less than</option>
          </select> 

        </div>
          
         <div class = "col-md-4" id =""> 
              <input type="text" name="" value="">
         </div>         

      </div>

    </div> 


</div>

</div>

<!--

-->


<div name="cardlist" id="cardlist">

<div style = "margin-left:2%;margin-right: 1%;" class="card" id="card" name="card">

  <div id="rcorners2" style="width:90%;">
    
    <div class="row" >
        
        <div class = "col-md-2" name ="formid" id ="formid">
            
            <select id="formidselect" name ="formidselect" class="form-control">                  
            </select>

        </div>

        

       <div class = "col-md-5"  name = "Questionid" id ="Questionid">
            
            <select id="Questionidselect"  name = "Questionidselect" class="form-control">
            </select>

        </div>


        <div class = "col-md-2" name= "Optionsparam" id ="Optionsparam" >

            <select class="form-control">
             <option value=""> equal </option>
             <option value="">not equal </option>
            <option value="">answered</option>
             <option value="">not answered</option>
            </select> 

        </div>

        <div id="Optionidselect" name="Optionidselect" class="col-md-3" style="max-height:100px;overflow: auto;">
              <ul class="list-group" name ="Optioncheckboxlist" id="Optioncheckboxlist">
              </ul>
        </div>

    </div>


<br>


<div id ="Operation" name="Operation">
      <div class="row">
        
        <div class = "col-md-4" id ="">

          <select>
           <option value="<=">greater than equal to </option>
           <option value=">=">less than equal to</option>
           <option value=">">greater than</option>
           <option value="<">less than</option>
          </select> 

        </div>
          
         <div class = "col-md-4" id =""> 
              <input type="text" name="" value="">
         </div>         

      </div>  
    
      <br>

    <div class="row">
        
        <div class = "col-md-4" id ="">

          <select>
           <option value="<=">greater than equal to </option>
           <option value=">=">less than equal to</option>
           <option value=">">greater than</option>
           <option type="checkbox" value="<">less than</option>
          </select> 

        </div>
          
         <div class = "col-md-4" id =""> 
              <input type="text" name="" value="">
         </div>         

      </div>

    </div> 


</div>

</div>

</div>


<div style = "margin-left:2%;margin-right: 1%;"> 
  <br>
  <br>
    <div class="row">
        
        <div class = "col-md-6" id ="">

          <button id="Add">ADD</button>

        </div> 
                
        <div class = "col-md-6" id ="">

            <button id="Submit" name="Submit">Submit</button>

        </div> 
         
        </div>
<div>

</body>

</html>

{% endblock %}

{% block sidebar %}
{% endblock %}

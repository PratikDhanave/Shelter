{% extends "admin/base_site.html" %}
{% load i18n %}
{% block breadcrumbs %}
{% load staticfiles %}
{% csrf_token %}

<link rel="stylesheet"  type="text/css" href="{% static "css/bootstrap.min.css" %}"/>
<script src="{% static "js/jquery.min.js" %}"></script>
<script src="{% static "js/bootstrap.min.js" %}"></script>

<div>
  <ol class="breadcrumb">
      <li><a href="{% url 'index' %}">Home</a></li>
  </ol>
</div>

<head>

<style>
  #rcorners2 {
    border-radius: 10px;
    border: 2px solid #dee0e2;
    background: white;
    padding: 20px;
    width:auto;
  }
</style>


<script>



var gform;

$(document).ready(function(){

    surveyformlist();

    $("#Questionid").hide();
 
    $("#Optionid").hide();

    $("#Optionsparam").hide(); 
    $("#Operation").hide();


    $("#formid").on('change',function()
    {
        questionlist();
    });

    $("#Questionid").on('change',function()
    {
        $("#Optionid").hide(); 
        optionlist();
    });

    $("button").click(function(){
        $(".card").clone().appendTo("#cardlist");
    });
});


function surveyformlist(){

    var url = "{% url 'surveyformlist' %}";

    $.ajax({

        url : url,

        //data : {},

        type: "GET",

        contenttype : "json",

        success : function(json){

              var str='<option value="';
              str = str +"0" +'"'+'>' + "---select---" + '</option>';
              $("[name='formidselect']").append(str);

        for (i = 0; i < json.nameArray.length; i++){
                var str='<option value="';
                str = str +json.idArray[i] +'"'+'>' + json.nameArray[i] + '</option>';
                $("[name='formidselect']").append(str);
            }

        }


    });

}



function questionlist(){

     $("#Optionid").hide(); 

     $("#Operation").hide();

    var formvalue = $("[name='formidselect'] option:selected").text();
    
    var formkey  = $("[name='formidselect'] option:selected").val();
    
    $('#Questionidselect').empty();

    var url = "{% url 'questionlist' %}";

    $.ajax({

        url : url,

        data : {id:formkey},

        type: "POST",

        contenttype : "json",

        success : function(json){

                gform=json["form"];                
                Questionarray=json["form"]; 

                if(Questionarray.length!=0)                 
                {  
                    var str='<option value="';
             
                    str = str +"0" +'"'+'>' + "---select---" + '</option>';
                    $('#Questionidselect').append(str);


                    for (i = 0; i < Questionarray.length; i++)
                    {
                        var str='<option value="';
                        str = str + Questionarray[i]["key"] +'"'+'>' + Questionarray[i]["value"] + '</option>';
                        $('#Questionidselect').append(str);
  
                    }  
                  
                    $("#Questionid").show();
                }  

              }  

    });


}

function optionlist(){

    $('#Optionidselect').empty();

    var questionname = $("#Questionidselect option:selected").val();
        
    var optionslistarray = new Array();

    console.log("initial value of optionslistarray");

    console.log(optionslistarray.length);

    try 
    {
        for (i = 0; i < gform.length; i++)
        {
          if(Questionarray[i]["key"]==questionname)
          {
             optionslistarray = Questionarray[i]["options"];
          }
        }
    }
    catch(err)
    {     
        
    }
    
    if (optionslistarray === undefined || optionslistarray === null) {
        optionslistarray = new Array();  
        console.log("I am here in undefined case");  
      
        $("#Operation").show();
        $("#Optionidselect").hide();
        $("#Optionsparam").hide(); 
    }

    console.log(optionslistarray.length);

    if(optionslistarray.length!=0)
    { 

        console.log("I am here in length check case");
 
        var str='<option value="';
        
        str = str +"0" +'"'+'>' + "---select---" + '</option>';
    
        $('#Optionidselect').append(str);


        for(i = 0; i < optionslistarray.length; i++)
        {
            var str='<option value="';
            str = str + optionslistarray[i]["key"] +'"'+'>' + optionslistarray[i]["value"] + '</option>';
            $('#Optionidselect').append(str);
  
        }  
     


        for(i = 0; i < optionslistarray.length; i++)
        {

          str = "<li class=\"list-group-item\"><input type=\"checkbox\">   " 

          str = str + optionslistarray[i]["value"] + "</li>"

          $('#Optioncheckboxlist').append(str);
  
        }  
     
         $("#Optionsparam").show(); 
         $("#Optionid").show(); 
        $("#Operation").hide();
      }
  
    console.log(optionslistarray);       
}


</script>

</head>

<body>

<div id="cardlist">

<div style = "margin-left:2%;margin-right: 1%;" class ="card">

  <div id="rcorners2" style="width:90%;">
    
    <div class="row" >
        
        <div class = "col-md-2" name ="formid" id ="formid">
            
            <select id="formidselect" name ="formidselect" class="form-control">                  
            </select>

        </div>

        

       <div class = "col-md-5" id ="Questionid">
            
            <select id="Questionidselect" class="form-control">
            </select>

        </div>


        <div class = "col-md-2" id ="Optionsparam" >

            <select class="form-control">
             <option value=""> equal </option>
             <option value="">not equal </option>
            <option value="">answered</option>
             <option value="">not answered</option>
            </select> 

        </div>

        <div class="col-md-3" style="max-height:100px;overflow: auto;">
              <ul class="list-group" id ="Optioncheckboxlist">
              </ul>
        </div>

    </div>









<div id ="Operation">
      <div class="row">
        
        <div class = "col-md-4" id ="">

          <select>
           <option value="<=">greater than equal to </option>
           <option value=">=">less than equal to</option>
           <option value=">">greater than</option>
           <option value="<">less than</option>
          </select> 

        </div>
          
         <div class = "col-md-4" id =""> 
              <input type="text" name="" value="">
         </div>         

      </div>  
    
      <br>

    <div class="row">
        
        <div class = "col-md-4" id ="">

          <select>
           <option value="<=">greater than equal to </option>
           <option value=">=">less than equal to</option>
           <option value=">">greater than</option>
           <option type="checkbox" value="<">less than</option>
          </select> 

        </div>
          
         <div class = "col-md-4" id =""> 
              <input type="text" name="" value="">
         </div>         

      </div>

    </div> 


</div>

</div>

</div>

<br>

<div style = "margin-left:2%;margin-right: 1%;"> 
    <button >ADD</button>
<div>

</body>

</html>

{% endblock %}

{% block sidebar %}
{% endblock %}
